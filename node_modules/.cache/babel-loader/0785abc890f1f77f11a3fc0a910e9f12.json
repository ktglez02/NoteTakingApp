{"ast":null,"code":"/**\n * @license\n * Copyright 2020 Google Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nvar FOCUS_SENTINEL_CLASS = 'mdc-dom-focus-sentinel';\n/**\n * Utility to trap focus in a given root element, e.g. for modal components such\n * as dialogs. The root should have at least one focusable child element,\n * for setting initial focus when trapping focus.\n * Also tracks the previously focused element, and restores focus to that\n * element when releasing focus.\n */\n\nvar FocusTrap =\n/** @class */\nfunction () {\n  function FocusTrap(root, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    this.root = root;\n    this.options = options; // Previously focused element before trapping focus.\n\n    this.elFocusedBeforeTrapFocus = null;\n  }\n  /**\n   * Traps focus in `root`. Also focuses on either `initialFocusEl` if set;\n   * otherwises sets initial focus to the first focusable child element.\n   */\n\n\n  FocusTrap.prototype.trapFocus = function () {\n    var focusableEls = this.getFocusableElements(this.root);\n\n    if (focusableEls.length === 0) {\n      throw new Error('FocusTrap: Element must have at least one focusable child.');\n    }\n\n    this.elFocusedBeforeTrapFocus = document.activeElement instanceof HTMLElement ? document.activeElement : null;\n    this.wrapTabFocus(this.root);\n\n    if (!this.options.skipInitialFocus) {\n      this.focusInitialElement(focusableEls, this.options.initialFocusEl);\n    }\n  };\n  /**\n   * Releases focus from `root`. Also restores focus to the previously focused\n   * element.\n   */\n\n\n  FocusTrap.prototype.releaseFocus = function () {\n    [].slice.call(this.root.querySelectorAll(\".\" + FOCUS_SENTINEL_CLASS)).forEach(function (sentinelEl) {\n      sentinelEl.parentElement.removeChild(sentinelEl);\n    });\n\n    if (!this.options.skipRestoreFocus && this.elFocusedBeforeTrapFocus) {\n      this.elFocusedBeforeTrapFocus.focus();\n    }\n  };\n  /**\n   * Wraps tab focus within `el` by adding two hidden sentinel divs which are\n   * used to mark the beginning and the end of the tabbable region. When\n   * focused, these sentinel elements redirect focus to the first/last\n   * children elements of the tabbable region, ensuring that focus is trapped\n   * within that region.\n   */\n\n\n  FocusTrap.prototype.wrapTabFocus = function (el) {\n    var _this = this;\n\n    var sentinelStart = this.createSentinel();\n    var sentinelEnd = this.createSentinel();\n    sentinelStart.addEventListener('focus', function () {\n      var focusableEls = _this.getFocusableElements(el);\n\n      if (focusableEls.length > 0) {\n        focusableEls[focusableEls.length - 1].focus();\n      }\n    });\n    sentinelEnd.addEventListener('focus', function () {\n      var focusableEls = _this.getFocusableElements(el);\n\n      if (focusableEls.length > 0) {\n        focusableEls[0].focus();\n      }\n    });\n    el.insertBefore(sentinelStart, el.children[0]);\n    el.appendChild(sentinelEnd);\n  };\n  /**\n   * Focuses on `initialFocusEl` if defined and a child of the root element.\n   * Otherwise, focuses on the first focusable child element of the root.\n   */\n\n\n  FocusTrap.prototype.focusInitialElement = function (focusableEls, initialFocusEl) {\n    var focusIndex = 0;\n\n    if (initialFocusEl) {\n      focusIndex = Math.max(focusableEls.indexOf(initialFocusEl), 0);\n    }\n\n    focusableEls[focusIndex].focus();\n  };\n\n  FocusTrap.prototype.getFocusableElements = function (root) {\n    var focusableEls = [].slice.call(root.querySelectorAll('[autofocus], [tabindex], a, input, textarea, select, button'));\n    return focusableEls.filter(function (el) {\n      var isDisabledOrHidden = el.getAttribute('aria-disabled') === 'true' || el.getAttribute('disabled') != null || el.getAttribute('hidden') != null || el.getAttribute('aria-hidden') === 'true';\n      var isTabbableAndVisible = el.tabIndex >= 0 && el.getBoundingClientRect().width > 0 && !el.classList.contains(FOCUS_SENTINEL_CLASS) && !isDisabledOrHidden;\n      var isProgrammaticallyHidden = false;\n\n      if (isTabbableAndVisible) {\n        var style = getComputedStyle(el);\n        isProgrammaticallyHidden = style.display === 'none' || style.visibility === 'hidden';\n      }\n\n      return isTabbableAndVisible && !isProgrammaticallyHidden;\n    });\n  };\n\n  FocusTrap.prototype.createSentinel = function () {\n    var sentinel = document.createElement('div');\n    sentinel.setAttribute('tabindex', '0'); // Don't announce in screen readers.\n\n    sentinel.setAttribute('aria-hidden', 'true');\n    sentinel.classList.add(FOCUS_SENTINEL_CLASS);\n    return sentinel;\n  };\n\n  return FocusTrap;\n}();\n\nexport { FocusTrap };","map":{"version":3,"mappings":"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","names":["FOCUS_SENTINEL_CLASS","root","options","FocusTrap","focusableEls","getFocusableElements","length","Error","elFocusedBeforeTrapFocus","document","activeElement","HTMLElement","wrapTabFocus","skipInitialFocus","focusInitialElement","initialFocusEl","slice","call","querySelectorAll","forEach","sentinelEl","parentElement","removeChild","skipRestoreFocus","focus","el","sentinelStart","createSentinel","sentinelEnd","addEventListener","_this","insertBefore","children","appendChild","focusIndex","Math","max","indexOf","filter","isDisabledOrHidden","getAttribute","isTabbableAndVisible","tabIndex","getBoundingClientRect","width","classList","contains","isProgrammaticallyHidden","style","getComputedStyle","display","visibility","sentinel","createElement","setAttribute","add"],"sources":["focus-trap.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}